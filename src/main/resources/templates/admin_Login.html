<html>
	<head>
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
		<!--<link href="css/admin.css" rel="stylesheet" type="text/css"/>-->

		<style>

			.adminLogin_top {
				width:100%;
				height:70px;
				background:rgba(0,0,0,0.3);
			}
			.adminLogin_top-title {
				position:relative;
				top:5px;
				font:400 50px/55px "microsoft yahei";
				color:rgba(255,255,255,1);
			}
			
			.adminLogin_middle {
				
				width:350px;
				height:290px;
				position:relative;
				left:50%;
				top:50%;
				margin-left: -175px;
				margin-top: -250px;
				
				background:rgba(0,0,0,0.3);

				border-radius: 10px;
			}

			.adminLogin_middle-form {
				margin:20px;
				color:rgba(255,255,255,1);
			}
			.adminLogin_middle-form-text {
				color:rgba(255,255,255,1);
			}
			.adminLogin_middle-form-text-bigger {
				font:400 20px/20px "microsoft yahei";
			}
			.adminLogin_middle-form-text-error {
				color:#e00;
			}
		</style>
	</head>
	<body>
		<div class="adminLogin_top">
			<p class="adminLogin_top-title adminLogin_text-left">&nbsp;图书馆</p>

		</div>

		<div class="adminLogin_middle">
			<form id="loginform">
				<div class="form-group adminLogin_middle-form">
					<br>
					<p class="adminLogin_middle-form-text adminLogin_middle-form-text-bigger">欢迎使用图书管理系统</p>
					<p class="adminLogin_middle-form-text ">请输入您的用户名和密码进行登录</p>
					<br>

					<input v-model='no' type="text" id="Aid" class="form-control" placeholder="在此输入账号">
					<input v-model='pwd' type="password" id="Apwd" class="form-control" placeholder="在此输入密码">

					<input type="radio" id="user" value="user" v-model="role" checked="true"></input>
					读者
					<input type="radio" id="sys" value="sys" v-model="role">
  					管理员
  					
					<button v-on:click="checklogin" type="button" class="btn btn-Default form-control">登录</button>
					<small  class="adminLogin_middle-form-text-error">{{error}}</small>
					<!--<p>{{no}}{{pwd}}</p>-->
					
				</div>
			</form>
		</div>
	</body>
	<script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script type="text/javascript" src="http://apps.bdimg.com/libs/vue/1.0.14/vue.js"></script>
	<script type="text/javascript">

        axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';
        Vue.prototype.$axios = axios;


		new Vue({
			el:'#loginform',
			data:{
				no:'',
				pwd:'',
				role:'user',
				error:'用户名或密码不能为空',
			},
			watch:{
				no:function(){
					this.checkIsNull();	
				},
				pwd:function(){
					this.checkIsNull();	
				}
			},
			methods:{
				checkIsNull:_.debounce(
					function(){
						if(this.no==''||this.pwd==''){
							this.error='用户名或密码不能为空';
							return
						}
						this.error='';
					},100
				),
				/*登录实现*/

				checklogin:function(){
					if(this.error==''&&this.no!=''&&this.pwd!='')
						this.login();
				},
				login:function(){
				    var vm=this;
                    var params = new URLSearchParams();
                    params.append('no', vm.no);
					params.append('pwd', vm.pwd);
					axios.post('sys/login',params).then(function(reponse){
						vm.error=reponse.data.msg;
                        console.log(reponse);
                        window.location.href="admin";

					}).catch(function(error){
                        console.log(error);
                    });
				}
				
			}
		});
	</script>
</html>